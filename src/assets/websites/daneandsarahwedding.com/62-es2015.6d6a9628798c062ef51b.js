(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{"68nU":function(e,t,i){"use strict";i.r(t),i.d(t,"GalleryPageModule",(function(){return z}));var n=i("SVse"),a=i("s7LF"),r=i("sZkV"),c=i("iInd"),o=i("mrSG"),s=i("d2z5"),g=i("8wRs"),l=i("8Y7J"),h=i("XNiG");class d{constructor(){this.imagesUpdatedSource=new h.a,this.imageSelectedIndexUpdatedSource=new h.a,this.showImageViewerSource=new h.a,this.imagesUpdated$=this.imagesUpdatedSource.asObservable(),this.imageSelectedIndexUpdated$=this.imageSelectedIndexUpdatedSource.asObservable(),this.showImageViewerChanged$=this.showImageViewerSource.asObservable()}updateImages(e){this.imagesUpdatedSource.next(e)}updateSelectedImageIndex(e){this.imageSelectedIndexUpdatedSource.next(e)}showImageViewer(e){this.showImageViewerSource.next(e)}}d.\u0275fac=function(e){return new(e||d)},d.\u0275prov=l.Yb({token:d,factory:d.\u0275fac});var m=i("IheW"),w=i("GS7A");function u(e,t){if(1&e&&l.dc(0,"div",9),2&e){const e=t.$implicit,i=t.index,n=l.rc(2);l.Hc("background-image",e.viewerImageLoaded?"url("+e[n.categorySelected].path+")":n.math.abs(n.currentIdx-i)<=1?"url("+e.preview_xs.path+")":"",l.Vb)("left",n.transform+"px"),l.Tb("active",e.active),l.wc("@imageTransition",e.transition)}}function M(e,t){if(1&e){const e=l.ic();l.hc(0,"img",10),l.pc("load",(function(){l.Cc(e);const i=t.$implicit;return l.rc(2).imageLoaded(i)})),l.gc()}if(2&e){const e=t.$implicit,i=t.index,n=l.rc(2);l.xc("src",n.math.abs(n.currentIdx-i)<=1?e[n.categorySelected].path:"",l.Ec)}}const I=function(e){return{activeArrow:e}};function p(e,t){if(1&e){const e=l.ic();l.hc(0,"div",1),l.pc("resize",(function(){l.Cc(e);return l.rc().onResize()}),!1,l.Bc),l.hc(1,"img",2),l.pc("click",(function(){l.Cc(e);return l.rc().navigate(-1,!1)})),l.gc(),l.hc(2,"img",3),l.pc("click",(function(){l.Cc(e);return l.rc().navigate(1,!1)})),l.gc(),l.hc(3,"div",4),l.hc(4,"img",5),l.pc("click",(function(){l.Cc(e);return l.rc().closeViewer()})),l.gc(),l.gc(),l.hc(5,"div",6),l.pc("click",(function(){l.Cc(e);return l.rc().showNavigationArrows()}))("swipeleft",(function(t){l.Cc(e);return l.rc().navigate(1,t)}))("swiperight",(function(t){l.Cc(e);return l.rc().navigate(-1,t)}))("pan",(function(t){l.Cc(e);return l.rc().pan(t)})),l.Ic(6,u,1,7,"div",7),l.Ic(7,M,1,1,"img",8),l.gc(),l.gc()}if(2&e){const e=l.rc();l.wc("@showViewerTransition",e.showViewer),l.Qb(1),l.wc("ngClass",l.yc(7,I,e.leftArrowActive))("hidden",!e.leftArrowVisible),l.Qb(1),l.wc("ngClass",l.yc(9,I,e.rightArrowActive))("hidden",!e.rightArrowVisible),l.Qb(4),l.wc("ngForOf",e.images),l.Qb(1),l.wc("ngForOf",e.images)}}class y{constructor(e){this.imageService=e,this.images=[{}],this.currentIdx=0,this.leftArrowVisible=!0,this.rightArrowVisible=!0,this.categorySelected="preview_xs",this.qualitySelectorShown=!1,this.qualitySelected="auto",e.imagesUpdated$.subscribe(e=>{this.images=e}),e.imageSelectedIndexUpdated$.subscribe(e=>{this.currentIdx=e,this.images.forEach(e=>e.active=!1),this.images[this.currentIdx].active=!0,this.transform=0,this.updateQuality()}),e.showImageViewerChanged$.subscribe(e=>{this.showViewer=e}),this.math=Math}get leftArrowActive(){return this.currentIdx>0}get rightArrowActive(){return this.currentIdx<this.images.length-1}pan(e){this.transform=e.deltaX}onResize(){this.images.forEach(e=>{e.viewerImageLoaded=!1,e.active=!1}),this.updateImage()}showQualitySelector(){this.qualitySelectorShown=!this.qualitySelectorShown}qualityChanged(e){this.qualitySelected=e,this.updateImage()}imageLoaded(e){e.viewerImageLoaded=!0}navigate(e,t){console.log(e,t),(1===e&&this.currentIdx<this.images.length-1||-1===e&&this.currentIdx>0)&&(-1==e?(this.images[this.currentIdx].transition="leaveToRight",this.images[this.currentIdx-1].transition="enterFromLeft"):(this.images[this.currentIdx].transition="leaveToLeft",this.images[this.currentIdx+1].transition="enterFromRight"),this.currentIdx+=e,t?this.hideNavigationArrows():this.showNavigationArrows(),this.updateImage())}showNavigationArrows(){this.leftArrowVisible=!0,this.rightArrowVisible=!0}closeViewer(){this.images.forEach(e=>e.transition=void 0),this.images.forEach(e=>e.active=!1),this.imageService.showImageViewer(!1)}onKeydown(e){const t=[37,39,27,36,35].find(t=>t===e.keyCode);switch(t&&e.preventDefault(),t){case 37:this.navigate(-1,!1);break;case 39:this.navigate(1,!1);break;case 27:this.closeViewer();break;case 36:this.images[this.currentIdx].transition="leaveToRight",this.currentIdx=0,this.images[this.currentIdx].transition="enterFromLeft",this.updateImage();break;case 35:this.images[this.currentIdx].transition="leaveToLeft",this.currentIdx=this.images.length-1,this.images[this.currentIdx].transition="enterFromRight",this.updateImage()}}hideNavigationArrows(){this.leftArrowVisible=!1,this.rightArrowVisible=!1}updateImage(){setTimeout(()=>{this.updateQuality(),this.images[this.currentIdx].active=!0,this.images.forEach(e=>{e!=this.images[this.currentIdx]&&(e.active=!1,this.transform=0)})},500)}updateQuality(){window.innerWidth,window.innerHeight;this.categorySelected="preview_xs"}}y.\u0275fac=function(e){return new(e||y)(l.cc(d))},y.\u0275cmp=l.Wb({type:y,selectors:[["viewer"]],hostBindings:function(e,t){1&e&&l.pc("keydown",(function(e){return t.onKeydown(e)}),!1,l.Ac)},decls:1,vars:1,consts:[["class","outerContainer",3,"resize",4,"ngIf"],[1,"outerContainer",3,"resize"],["src","data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0cHgiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjx0aXRsZS8+PGRlc2MvPiAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgaWQ9Im1pdSIgc3Ryb2tlPSIjNTU1IiBzdHJva2Utd2lkdGg9IjAuMiI+ICAgICA8ZyBpZD0iQXJ0Ym9hcmQtMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM5NS4wMDAwMDAsIC0xOTEuMDAwMDAwKSI+PGcgaWQ9InNsaWNlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTUuMDAwMDAwLCAxMTkuMDAwMDAwKSIvPjxwYXRoICAgICAgIGQ9Ik0zOTYsMjAyLjUgQzM5NiwxOTYuMTQ4NzI1IDQwMS4xNDg3MjUsMTkxIDQwNy41LDE5MSBDNDEzLjg1MTI3NSwxOTEgNDE5LDE5Ni4xNDg3MjUgNDE5LDIwMi41IEM0MTksMjA4Ljg1MTI3NSA0MTMuODUxMjc1LDIxNCA0MDcuNSwyMTQgQzQwMS4xNDg3MjUsMjE0IDM5NiwyMDguODUxMjc1IDM5NiwyMDIuNSBaIE00MDguNjU2ODU0LDE5Ni44NDMxNDYgTDQxMC4wNzEwNjgsMTk4LjI1NzM1OSBMNDA1LjgyODQyNywyMDIuNSBMNDEwLjA3MTA2OCwyMDYuNzQyNjQxIEw0MDguNjU2ODU0LDIwOC4xNTY4NTQgTDQwMywyMDIuNSBMNDA4LjY1Njg1NCwxOTYuODQzMTQ2IFoiICAgICAgIGZpbGw9IiNhYWEiICAgICAgIGlkPSJjaXJjbGUtYmFjay1hcnJvdy1nbHlwaCIvPjwvZz4gICA8L2c+IDwvc3ZnPg==",1,"arrow","left",3,"ngClass","hidden","click"],["src","data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0cHgiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjx0aXRsZS8+PGRlc2MvPjxkZWZzLz4gICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGlkPSJtaXUiIHN0cm9rZT0iIzU1NSIgc3Ryb2tlLXdpZHRoPSIwLjIiPiAgICAgPGcgaWQ9IkFydGJvYXJkLTEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00NjcuMDAwMDAwLCAtMTkxLjAwMDAwMCkiPjxnIGlkPSJzbGljZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE1LjAwMDAwMCwgMTE5LjAwMDAwMCkiLz48cGF0aCAgICAgICBkPSJNNDY4LDIwMi41IEM0NjgsMTk2LjE0ODcyNSA0NzMuMTQ4NzI1LDE5MSA0NzkuNSwxOTEgQzQ4NS44NTEyNzUsMTkxIDQ5MSwxOTYuMTQ4NzI1IDQ5MSwyMDIuNSBDNDkxLDIwOC44NTEyNzUgNDg1Ljg1MTI3NSwyMTQgNDc5LjUsMjE0IEM0NzMuMTQ4NzI1LDIxNCA0NjgsMjA4Ljg1MTI3NSA0NjgsMjAyLjUgWiBNNDgwLjY1Njg1NCwxOTYuODQzMTQ2IEw0ODIuMDcxMDY4LDE5OC4yNTczNTkgTDQ3Ny44Mjg0MjcsMjAyLjUgTDQ4Mi4wNzEwNjgsMjA2Ljc0MjY0MSBMNDgwLjY1Njg1NCwyMDguMTU2ODU0IEw0NzUsMjAyLjUgTDQ4MC42NTY4NTQsMTk2Ljg0MzE0NiBaIiAgICAgICBmaWxsPSIjYWFhIiAgICAgICBpZD0iY2lyY2xlLW5leHQtYXJyb3ctZGlzY2xvc3VyZS1nbHlwaCIgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDc5LjUwMDAwMCwgMjAyLjUwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNDc5LjUwMDAwMCwgLTIwMi41MDAwMDApICIvPjwvZz4gICA8L2c+IDwvc3ZnPg==",1,"arrow","right",3,"ngClass","hidden","click"],[1,"buttonContainer"],["src","data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwcHgiIGlkPSJMYXllcl8xIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgdmVyc2lvbj0iMS4xIiBmaWxsPSIjYWFhIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPiAgPHBhdGggICAgc3Ryb2tlLXdpZHRoPSIzMCIgc3Ryb2tlPSIjNDQ0IiAgICBkPSJNNDM3LjUsMzg2LjZMMzA2LjksMjU2bDEzMC42LTEzMC42YzE0LjEtMTQuMSwxNC4xLTM2LjgsMC01MC45Yy0xNC4xLTE0LjEtMzYuOC0xNC4xLTUwLjksMEwyNTYsMjA1LjFMMTI1LjQsNzQuNSAgYy0xNC4xLTE0LjEtMzYuOC0xNC4xLTUwLjksMGMtMTQuMSwxNC4xLTE0LjEsMzYuOCwwLDUwLjlMMjA1LjEsMjU2TDc0LjUsMzg2LjZjLTE0LjEsMTQuMS0xNC4xLDM2LjgsMCw1MC45ICBjMTQuMSwxNC4xLDM2LjgsMTQuMSw1MC45LDBMMjU2LDMwNi45bDEzMC42LDEzMC42YzE0LjEsMTQuMSwzNi44LDE0LjEsNTAuOSwwQzQ1MS41LDQyMy40LDQ1MS41LDQwMC42LDQzNy41LDM4Ni42eiIvPjwvc3ZnPg==",1,"action","close",3,"click"],[1,"imageContainer",3,"click","swipeleft","swiperight","pan"],["class","image",3,"active","background-image","left",4,"ngFor","ngForOf"],["class","preloading-image",3,"src","load",4,"ngFor","ngForOf"],[1,"image"],[1,"preloading-image",3,"src","load"]],template:function(e,t){1&e&&l.Ic(0,p,8,11,"div",0),2&e&&l.wc("ngIf",t.showViewer)},directives:[n.j,n.h,n.i],styles:['.outerContainer[_ngcontent-%COMP%]{top:0;bottom:0;left:0;right:0;height:100%;width:100%;position:fixed;background-color:#000;font-family:sans-serif;z-index:1031}.imageContainer[_ngcontent-%COMP%]{position:absolute;float:none;top:0;bottom:0;left:0;right:0}.imageContainer[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .imageContainer[_ngcontent-%COMP%]   .preloading-image[_ngcontent-%COMP%]{visibility:hidden}.imageContainer[_ngcontent-%COMP%]   .image.active[_ngcontent-%COMP%]{position:absolute;visibility:visible;background-repeat:no-repeat;background-size:contain;background-position:50%;margin:auto;left:0;right:0;top:0;bottom:0;height:100%;width:100%;opacity:1}.arrow[_ngcontent-%COMP%]{opacity:0}.arrow[_ngcontent-%COMP%]:hover{cursor:pointer}.outerContainer[_ngcontent-%COMP%]:hover   .arrow.activeArrow[_ngcontent-%COMP%]{height:calc(20px + 1.5vw);position:absolute;top:calc(50% - 10px - .75vw);bottom:50%;z-index:1;opacity:1;transition:all .5s ease-out}.arrow.left[_ngcontent-%COMP%]{left:2vw}.arrow.right[_ngcontent-%COMP%]{right:2vw}.arrow[_ngcontent-%COMP%]:not(.activeArrow):hover{opacity:0;cursor:pointer;transition:all .5s ease-out}.buttonContainer[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;height:20px;text-align:center;opacity:1;z-index:200;transition:all .5s ease-out}.buttonContainer[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{height:100%;cursor:pointer;vertical-align:top}.buttonContainer[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:focus{outline:0}.buttonContainer[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{background-color:#222;transition:all .3s ease-out}.buttonContainer[_ngcontent-%COMP%]   .action.close[_ngcontent-%COMP%]{width:26px;height:26px}md-button-toggle.checked[_ngcontent-%COMP%]{background-color:#a0a0a0}.menuButton[_ngcontent-%COMP%]{position:absolute;bottom:20px;right:20px;text-align:center;opacity:1;z-index:200;transition:all .5s ease-out}@font-face{font-family:Material Icons;font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url(https://fonts.gstatic.com/s/materialicons/v19/2fcrYFNaTjcS6g4U3t-Y5ZjZjT5FdEJ140U2DJYC3mY.woff2) format("woff2")}.material-icons[_ngcontent-%COMP%]{font-family:Material Icons;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;font-feature-settings:"liga";-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased}'],data:{animation:[Object(w.j)("imageTransition",[Object(w.g)("enterFromRight",Object(w.h)({opacity:1,transform:"translate(0px, 0px)"})),Object(w.g)("enterFromLeft",Object(w.h)({opacity:1,transform:"translate(0px, 0px)"})),Object(w.g)("leaveToLeft",Object(w.h)({opacity:0,transform:"translate(-100px, 0px)"})),Object(w.g)("leaveToRight",Object(w.h)({opacity:0,transform:"translate(100px, 0px)"})),Object(w.i)("* => enterFromRight",[Object(w.h)({opacity:0,transform:"translate(30px, 0px)"}),Object(w.e)("250ms 500ms ease-in")]),Object(w.i)("* => enterFromLeft",[Object(w.h)({opacity:0,transform:"translate(-30px, 0px)"}),Object(w.e)("250ms 500ms ease-in")]),Object(w.i)("* => leaveToLeft",[Object(w.h)({opacity:1}),Object(w.e)("250ms ease-out")]),Object(w.i)("* => leaveToRight",[Object(w.h)({opacity:1}),Object(w.e)("250ms ease-out")])]),Object(w.j)("showViewerTransition",[Object(w.g)("true",Object(w.h)({opacity:1})),Object(w.g)("void",Object(w.h)({opacity:0})),Object(w.i)("void => *",[Object(w.h)({opacity:0}),Object(w.e)("1000ms ease-in")]),Object(w.i)("* => void",[Object(w.h)({opacity:1}),Object(w.e)("500ms ease-out")])])]}});const b=["galleryContainer"],C=["imageElement"];function v(e,t){if(1&e){const e=l.ic();l.hc(0,"img",8,9),l.pc("click",(function(){l.Cc(e);const i=t.$implicit;return l.rc(2).openImageViewer(i)})),l.gc()}if(2&e){const e=t.$implicit,i=l.rc(2);l.Hc("width",e.width,"px")("height",e.height,"px")("background",e.dominantColor,l.Vb)("margin-right",i.calcImageMargin(),"px"),l.wc("src",e.srcAfterFocus,l.Ec)}}function x(e,t){if(1&e&&(l.hc(0,"div",6),l.Ic(1,v,2,9,"img",7),l.gc()),2&e){const e=t.$implicit,i=l.rc();l.Hc("margin-bottom",i.calcImageMargin(),"px"),l.wc("hidden",!i.hasRenderedFinal),l.Qb(1),l.wc("ngForOf",e)}}const j=function(e){return{inactive:e}};function f(e,t){if(1&e){const e=l.ic();l.hc(0,"div",10),l.hc(1,"img",11),l.pc("click",(function(){l.Cc(e);return l.rc().navigate(-1)})),l.gc(),l.hc(2,"img",12),l.pc("click",(function(){l.Cc(e);return l.rc().navigate(1)})),l.gc(),l.gc()}if(2&e){const e=l.rc();l.wc("hidden",!e.hasRenderedFinal),l.Qb(1),l.wc("ngClass",l.yc(3,j,e.leftArrowInactive)),l.Qb(1),l.wc("ngClass",l.yc(5,j,e.rightArrowInactive))}}function D(e,t){1&e&&(l.hc(0,"div",13),l.hc(1,"div",14),l.dc(2,"ion-spinner",15),l.gc(),l.gc())}class L{constructor(e,t,i){this.imageService=e,this.http=t,this.changeDetectorRef=i,this.gallery=[],this.imageDataStaticPath="assets/img/gallery/",this.imageDataCompletePath="",this.dataFileName="data.json",this.images=[],this.minimalQualityCategory="preview_xs",this.rowIndex=0,this.rightArrowInactive=!1,this.leftArrowInactive=!1,this.shouldRenderFinal=!1,this.hasRenderedFinal=!1,this.providedImageMargin=3,this.providedImageSize=7,this.providedGalleryName="",this.providedMetadataUri=void 0,this.rowsPerPage=200,this.viewerChange=new l.t}triggerCycle(e){this.scaleGallery()}windowResize(e){this.render()}ngOnInit(){this.fetchDataAndRender(),this.viewerSubscription=this.imageService.showImageViewerChanged$.subscribe(e=>this.viewerChange.emit(e)),setTimeout(()=>{this.shouldRenderFinal&&this.render()},1e3)}ngOnChanges(e){null!=e.providedGalleryName?this.fetchDataAndRender():this.render()}ngOnDestroy(){this.viewerSubscription&&this.viewerSubscription.unsubscribe()}openImageViewer(e){this.imageService.updateImages(this.images),this.imageService.updateSelectedImageIndex(this.images.indexOf(e)),this.imageService.showImageViewer(!0)}navigate(e){(1===e&&this.rowIndex<this.gallery.length-this.rowsPerPage||-1===e&&this.rowIndex>0)&&(this.rowIndex+=this.rowsPerPage*e),this.refreshNavigationErrorState()}calcImageMargin(){const e=this.getGalleryWidth()/1920;return Math.round(Math.max(1,this.providedImageMargin*e))}fetchDataAndRender(){this.imageDataCompletePath=this.providedMetadataUri,this.providedMetadataUri||(this.imageDataCompletePath=""!==this.providedGalleryName?`${this.imageDataStaticPath+this.providedGalleryName}/${this.dataFileName}`:this.imageDataStaticPath+this.dataFileName),this.http.get(this.imageDataCompletePath).subscribe(e=>{this.images=e,this.imageService.updateImages(this.images),this.images.forEach(e=>{e.galleryImageLoaded=!1,e.viewerImageLoaded=!1,e.srcAfterFocus=""}),this.render(),this.render()},e=>{this.providedMetadataUri?console.error(`Provided endpoint '${this.providedMetadataUri}' did not serve metadata correctly or in the expected format.\n      See here for more information: https://github.com/BenjaminBrandmeier/angular2-image-gallery/blob/master/docs/externalDataSource.md,\n      Original error: ${e}`):console.error("Did you run the convert script from angular2-image-gallery for your images first? Original error: "+e)},()=>{})}render(){this.gallery=[];let e=[this.images[0]],t=0,i=0;for(;i<this.images.length;i++){for(0===this.images[i].width?this.shouldRenderFinal=!0:setTimeout(()=>{this.hasRenderedFinal=!0},2e3);this.images[i+1]&&this.shouldAddCandidate(e,this.images[i+1]);)i++;this.images[i+1]&&e.pop(),this.gallery[t++]=e,e=[this.images[i+1]]}this.scaleGallery()}shouldAddCandidate(e,t){const i=this.calcIdealHeight()-this.calcRowHeight(e);e.push(t);const n=this.calcIdealHeight()-this.calcRowHeight(e);return Math.abs(i)>Math.abs(n)}calcRowHeight(e){const t=this.calcOriginalRowWidth(e),i=(this.getGalleryWidth()-(e.length-1)*this.calcImageMargin())/t;return e[0][this.minimalQualityCategory].height*i}calcOriginalRowWidth(e){let t=0;return e.forEach(e=>{const i=this.calcIdealHeight()/e[this.minimalQualityCategory].height;e[this.minimalQualityCategory].width=e[this.minimalQualityCategory].width*i,e[this.minimalQualityCategory].height=this.calcIdealHeight(),t+=e[this.minimalQualityCategory].width}),t}calcIdealHeight(){return this.getGalleryWidth()/(80/this.providedImageSize)+100}getGalleryWidth(){return 0===this.galleryContainer.nativeElement.clientWidth?this.galleryContainer.nativeElement.scrollWidth:this.galleryContainer.nativeElement.clientWidth}scaleGallery(){let e=0,t=0;this.gallery.slice(this.rowIndex,this.rowIndex+this.rowsPerPage).forEach(i=>{const n=this.calcOriginalRowWidth(i);if(i!==this.gallery[this.gallery.length-1]){const a=(this.getGalleryWidth()-(i.length-1)*this.calcImageMargin())/n;i.forEach(i=>{i.width=i[this.minimalQualityCategory].width*a,i.height=i[this.minimalQualityCategory].height*a,t=Math.max(t,i.height),this.checkForAsyncLoading(i,e++)})}else i.forEach(i=>{i.width=i[this.minimalQualityCategory].width,i.height=i[this.minimalQualityCategory].height,t=Math.max(t,i.height),this.checkForAsyncLoading(i,e++)})}),this.minimalQualityCategory="preview_xs",this.refreshNavigationErrorState(),this.changeDetectorRef.detectChanges()}checkForAsyncLoading(e,t){const i=this.imageElements.toArray();e.galleryImageLoaded||i.length>0&&i[t]&&this.isScrolledIntoView(i[t].nativeElement)?(e.galleryImageLoaded=!0,e.srcAfterFocus=e[this.minimalQualityCategory].path):e.srcAfterFocus=""}isScrolledIntoView(e){return!0}refreshNavigationErrorState(){this.leftArrowInactive=0==this.rowIndex,this.rightArrowInactive=this.rowIndex>this.gallery.length-this.rowsPerPage}}function N(e,t){if(1&e){const e=l.ic();l.hc(0,"div",1),l.hc(1,"ion-header"),l.hc(2,"ion-toolbar",2),l.hc(3,"ion-title",3),l.hc(4,"ion-grid"),l.hc(5,"ion-row"),l.hc(6,"ion-col",4),l.hc(7,"ion-buttons"),l.hc(8,"ion-button",5),l.pc("click",(function(t){l.Cc(e);return l.rc().presentGalleryPopover(t)})),l.hc(9,"ion-label"),l.Jc(10),l.gc(),l.dc(11,"ion-icon",6),l.gc(),l.gc(),l.gc(),l.hc(12,"ion-col",7),l.Jc(13),l.gc(),l.gc(),l.gc(),l.gc(),l.gc(),l.gc(),l.hc(14,"div",8),l.dc(15,"gallery",9),l.gc(),l.gc()}if(2&e){const e=l.rc();l.Qb(10),l.Kc(e.gallery.title),l.Qb(3),l.Lc(" ",e.gallery.date," "),l.Qb(2),l.wc("galleryName",e.gallery.name)("metadataUri",e.metadataUri)}}L.\u0275fac=function(e){return new(e||L)(l.cc(d),l.cc(m.a),l.cc(l.j))},L.\u0275cmp=l.Wb({type:L,selectors:[["gallery"]],viewQuery:function(e,t){var i;(1&e&&(l.Gc(b,!0),l.Oc(C,!0)),2&e)&&(l.zc(i=l.qc())&&(t.galleryContainer=i.first),l.zc(i=l.qc())&&(t.imageElements=i))},hostBindings:function(e,t){1&e&&l.pc("scroll",(function(e){return t.triggerCycle(e)}),!1,l.Bc)("resize",(function(e){return t.windowResize(e)}),!1,l.Bc)},inputs:{providedImageMargin:["flexBorderSize","providedImageMargin"],providedImageSize:["flexImageSize","providedImageSize"],providedGalleryName:["galleryName","providedGalleryName"],providedMetadataUri:["metadataUri","providedMetadataUri"],rowsPerPage:["maxRowsPerPage","rowsPerPage"]},outputs:{viewerChange:"viewerChange"},features:[l.Ob],decls:8,vars:7,consts:[[1,"galleryContainer"],["galleryContainer",""],[1,"innerGalleryContainer"],["class","imagerow",3,"margin-bottom","hidden",4,"ngFor","ngForOf"],["class","pagerContainer",3,"hidden",4,"ngIf"],["class","content-outer center-content-vertical center-content-horizontal",4,"ngIf"],[1,"imagerow",3,"hidden"],["class","thumbnail",3,"width","height","src","background","margin-right","click",4,"ngFor","ngForOf"],[1,"thumbnail",3,"src","click"],["imageElement",""],[1,"pagerContainer",3,"hidden"],["src","data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaWQ9IkxheWVyXzEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ4IDQ4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDggNDgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxnPjxwYXRoIGQ9Ik0yNCw0NkMxMS45LDQ2LDIsMzYuMSwyLDI0UzExLjksMiwyNCwyczIyLDkuOSwyMiwyMlMzNi4xLDQ2LDI0LDQ2eiBNMjQsNEMxMyw0LDQsMTMsNCwyNGMwLDExLDksMjAsMjAsMjAgICBjMTEsMCwyMC05LDIwLTIwQzQ0LDEzLDM1LDQsMjQsNHoiLz48L2c+PGc+PHBvbHlnb24gcG9pbnRzPSIyNy42LDM2LjcgMTQuOSwyNCAyNy42LDExLjMgMjkuMSwxMi43IDE3LjgsMjQgMjkuMSwzNS4zICAiLz48L2c+PC9zdmc+",1,"pager","left",3,"ngClass","click"],["src","data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaWQ9IkxheWVyXzEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ4IDQ4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDggNDgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxnPjxwYXRoIGQ9Ik0yNCw0NkMxMS45LDQ2LDIsMzYuMSwyLDI0UzExLjksMiwyNCwyczIyLDkuOSwyMiwyMlMzNi4xLDQ2LDI0LDQ2eiBNMjQsNEMxMyw0LDQsMTMsNCwyNHM5LDIwLDIwLDIwczIwLTksMjAtMjAgICBTMzUsNCwyNCw0eiIvPjwvZz48Zz48cG9seWdvbiBwb2ludHM9IjIxLjQsMzYuNyAxOS45LDM1LjMgMzEuMiwyNCAxOS45LDEyLjcgMjEuNCwxMS4zIDM0LjEsMjQgICIvPjwvZz48L3N2Zz4=",1,"pager","right",3,"ngClass","click"],[1,"content-outer","center-content-vertical","center-content-horizontal"],[1,"content-inner"],["color","dark"]],template:function(e,t){1&e&&(l.hc(0,"div",0,1),l.hc(2,"div",2),l.Ic(3,x,2,4,"div",3),l.sc(4,"slice"),l.gc(),l.Ic(5,f,3,7,"div",4),l.Ic(6,D,3,0,"div",5),l.gc(),l.dc(7,"viewer")),2&e&&(l.Qb(3),l.wc("ngForOf",l.tc(4,3,t.gallery,t.rowIndex,t.rowIndex+t.rowsPerPage)),l.Qb(2),l.wc("ngIf",!t.rightArrowInactive||!t.leftArrowInactive),l.Qb(1),l.wc("ngIf",!t.hasRenderedFinal))},directives:[n.i,n.j,y,n.h,r.z],pipes:[n.m],styles:[".innerGalleryContainer[_ngcontent-%COMP%]{position:relative}.galleryContainer[_ngcontent-%COMP%]{height:100%;width:100%;overflow:hidden}.innerGalleryContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:last-child{margin-right:-1px!important}.galleryContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:brightness(50%);transition:all .2s ease-out;cursor:pointer}.imagerow[_ngcontent-%COMP%]{margin-right:1px;overflow:hidden;display:flex}[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.asyncLoadingContainer[_ngcontent-%COMP%]{position:absolute;background-color:transparent;height:0;width:0;bottom:120px}.pagerContainer[_ngcontent-%COMP%]{margin:40px auto;width:180px}@media (max-width:700px){.pagerContainer[_ngcontent-%COMP%]{margin:40px auto;width:150px}}.pager[_ngcontent-%COMP%]{display:block;height:60px}@media (max-width:700px){.pager[_ngcontent-%COMP%]{display:block;height:45px}}.pager.inactive[_ngcontent-%COMP%]{opacity:.15}.pager.left[_ngcontent-%COMP%]{float:left}.pager.right[_ngcontent-%COMP%]{float:right}.content-outer[_ngcontent-%COMP%]{height:calc(100vh - 180px)}ion-spinner[_ngcontent-%COMP%]{width:75px;height:75px}"]});class A{constructor(e,t,i){this.utilsService=e,this.activatedRoute=t,this.popoverController=i}get metadataUri(){return this.gallery?`assets/images/gallery/${this.gallery.name}/data.json`:void 0}ionViewDidEnter(){this.activatedRoute.params.subscribe(e=>{this.gallery=this.utilsService.galleryData.find(t=>t.name===e.galleryName),this.utilsService.setTitle(this.gallery.title+" Gallery")})}presentGalleryPopover(e){return Object(o.a)(this,void 0,void 0,(function*(){(yield this.popoverController.create({event:e,component:s.a})).present()}))}}A.\u0275fac=function(e){return new(e||A)(l.cc(g.a),l.cc(c.a),l.cc(r.I))},A.\u0275cmp=l.Wb({type:A,selectors:[["app-gallery"]],decls:2,vars:1,consts:[["class","content-outer page-outer",4,"ngIf"],[1,"content-outer","page-outer"],["color","primary"],[1,"content-inner","title","grid"],["size","6"],[1,"title-button",3,"click"],["slot","end","name","caret-down"],["size","6",1,"ion-text-right","gallery-date"],[1,"content-inner","gallery"],[3,"galleryName","metadataUri"]],template:function(e,t){1&e&&(l.hc(0,"ion-content"),l.Ic(1,N,16,4,"div",0),l.gc()),2&e&&(l.Qb(1),l.wc("ngIf",t.gallery))},directives:[r.j,n.j,r.m,r.C,r.B,r.l,r.w,r.i,r.d,r.c,r.r,r.n,L],styles:[".title-button[_ngcontent-%COMP%]{margin-bottom:2px}.title-button[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:20px!important}.title-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px;margin-left:4px}.gallery-date[_ngcontent-%COMP%]{padding-top:14px}.content-inner.gallery[_ngcontent-%COMP%]{min-height:calc(100% - 56px)}"]});const O=[{path:"",component:A}];class S{}S.\u0275mod=l.ac({type:S}),S.\u0275inj=l.Zb({factory:function(e){return new(e||S)},imports:[[c.j.forChild(O)],c.j]});class P{}P.\u0275mod=l.ac({type:P}),P.\u0275inj=l.Zb({factory:function(e){return new(e||P)},providers:[d],imports:[[n.b,a.a,m.b,r.D]]});class z{}z.\u0275mod=l.ac({type:z}),z.\u0275inj=l.Zb({factory:function(e){return new(e||z)},imports:[[n.b,a.a,r.D,S,P]]})}}]);